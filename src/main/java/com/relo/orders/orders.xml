<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.relo.auction.mybatis.Orders">
<resultMap id="productMap" type="com.relo.orders.OrdersVo" autoMapping="true">
	<id property="pNum" column="p_num"/>
	<association property="stock" javaType="com.relo.stock.StockVo" autoMapping="true">
	</association>

	<collection property="a" ofType="Auction" autoMapping="true">
		<id property="aNum" column="a_num" /> 
	</collection>
</resultMap>
<select id="selectByPStatus" resultMap="productMap">
select p.p_num, a.a_num , a.id, a.a_price, s.s_name  "stock.s_name" 
from auction a, product p, stock s  
where p.p_status = 6  and a.a_price 
in (  
  select max(a_price)   
  from auction   
  where p_num=p.p_num)  
and a.p_num = p.p_num  
and p.s_num = s.s_num
</select>
</mapper>